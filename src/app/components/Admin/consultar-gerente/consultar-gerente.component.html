<div class="min-h-screen" [style.background]="'linear-gradient(to bottom right, rgba(var(--color-primary-rgb), 0.05), white, rgba(var(--color-primary-rgb), 0.05))'">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Header -->
    <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 overflow-hidden mb-6">
      <div class="p-6 sm:p-8 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4" [style.background]="'linear-gradient(to right, var(--color-primary), var(--color-accent))'">
        <h2 class="text-2xl sm:text-3xl font-bold text-white mb-0">Consultar gerentes</h2>
        <button
          class="bg-white text-sm sm:text-base px-4 sm:px-6 py-2 sm:py-3 rounded-lg hover:bg-gray-100 transition-all duration-200 flex items-center gap-2 font-semibold"
          [style.color]="'var(--color-primary)'"
          routerLink="/panel/usuarios/gerente/crear"
          title="Crear nuevo gerente"
        >
          <i class="fa-solid fa-plus"></i>
          Crear Gerente
        </button>
      </div>
    </div>

    <!-- Tabs -->
    <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 overflow-hidden mb-6">
      <ul class="nav flex border-b" id="myTab" role="tablist">
        <li class="nav-item flex-1" role="presentation">
          <button
            class="nav-link w-full py-4 px-6 text-base sm:text-lg font-semibold transition-all duration-200 border-b-2"
            [style.border-bottom-color]="activeTab === 'asignados' ? 'var(--color-primary)' : 'transparent'"
            [style.color]="activeTab === 'asignados' ? 'var(--color-primary)' : '#6b7280'"
            id="home-tab"
            data-bs-toggle="tab"
            data-bs-target="#asignados"
            type="button"
            role="tab"
            (click)="setActiveTab('asignados')"
          >
            Asignados
          </button>
        </li>
        <li class="nav-item flex-1" role="presentation">
          <button
            class="nav-link w-full py-4 px-6 text-base sm:text-lg font-semibold transition-all duration-200 border-b-2"
            [style.border-bottom-color]="activeTab === 'noasignados' ? 'var(--color-primary)' : 'transparent'"
            [style.color]="activeTab === 'noasignados' ? 'var(--color-primary)' : '#6b7280'"
            id="profile-tab"
            data-bs-toggle="tab"
            data-bs-target="#noasignados"
            type="button"
            role="tab"
            (click)="setActiveTab('noasignados')"
          >
            No asignados
          </button>
        </li>
      </ul>
      <div class="tab-content p-6 sm:p-8" id="myTabContent">
        <div class="tab-pane fade show active" id="asignados" role="tabpanel">
          <!-- Loading State -->
          <div *ngIf="loading" class="flex items-center justify-center py-12">
            <div class="animate-spin rounded-full h-10 w-10 border-b-2" [style.border-color]="'var(--color-primary)'"></div>
            <span class="ml-3 text-gray-600 text-lg">Cargando gerentes...</span>
          </div>
          
          <div
            class="table-responsive my-4"
            *ngIf="!loading && listGerenteAsignados.length > 0; else municipio_content"
          >
            <table
              datatable
              [dtOptions]="dtOptionsGerenteAsignados"
              [dtTrigger]="dtTrigger"
              class="table text-center align-middle w-100"
            >
              <thead class="align-middle" [style.background]="'linear-gradient(to right, rgba(var(--color-primary-rgb), 0.1), rgba(var(--color-primary-rgb), 0.15))'">
                <tr>
                  <th scope="col" class="font-semibold py-4 px-4" [style.color]="'var(--color-primary)'">NOMBRE COMPLETO</th>
                  <th scope="col" class="font-semibold py-4 px-4" [style.color]="'var(--color-primary)'">TELÉFONO</th>
                  <th scope="col" class="font-semibold py-4 px-4" [style.color]="'var(--color-primary)'">CORREO ELECTRÓNICO</th>
                  <th scope="col" class="font-semibold py-4 px-4" [style.color]="'var(--color-primary)'">MUNICIPIOS</th>
                  <th scope="col" class="font-semibold py-4 px-4" [style.color]="'var(--color-primary)'"></th>
                </tr>
              </thead>
              <tbody>
                <tr
                  class="text-center hover:bg-gray-50 transition-colors duration-200 border-b border-gray-100"
                  *ngFor="
                    let gerente of listGerenteAsignados;
                    let index = index
                  "
                >
                  <td class="py-4 px-4 text-gray-900 font-medium">{{ gerente.nombres }} {{ gerente.apellidos }}</td>
                  <td class="py-4 px-4 text-gray-700">{{ gerente.telefono }}</td>
                  <td class="py-4 px-4 text-gray-700">{{ gerente.email }}</td>
                  <td class="py-4 px-4 text-gray-700">{{ listMunicipals[index] }}</td>
                  <td class="py-4 px-4">
                    <div
                      class="flex flex-wrap gap-2 justify-center items-center"
                    >
                      <button
                        class="p-2 rounded-lg hover:bg-gray-100 transition-all duration-200"
                        [style.color]="'var(--color-primary)'"
                        data-bs-toggle="modal"
                        data-bs-target="#gerente"
                        (click)="
                          gerenteActualSeleccionado(
                            gerente,
                            listMunicipals[index]
                          )
                        "
                        data-bs-placement="top"
                        title="Ver más"
                      >
                        <i class="fa-solid fa-eye"></i>
                      </button>
                      <button
                        class="p-2 rounded-lg hover:bg-gray-100 transition-all duration-200"
                        [style.color]="'var(--color-primary)'"
                        (click)="redirectUpdateGerente(gerente.id)"
                        data-bs-placement="top"
                        title="Editar información"
                      >
                        <i class="fa-solid fa-pen"></i>
                      </button>
                      <!--<button class="btn align-middle" data-bs-placement="top"
                                                title="Cambiar de rol" (click)="redirectSwitchRolGerente(gerente.id)">
                                                <img src="../../../../assets/changeRol.svg" class="icon-change-rol">
                                            </button>-->
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <ng-template #municipio_content>
            <div class="text-center py-12" *ngIf="!loading">
              <i class="fas fa-users text-5xl mb-4" [style.color]="'rgba(var(--color-primary-rgb), 0.3)'"></i>
              <p class="text-gray-600 text-lg">
                No hay gerentes con asignación de municipio.
              </p>
            </div>
          </ng-template>
        </div>
        <div class="tab-pane fade" id="noasignados" role="tabpanel">
          <!-- Loading State -->
          <div *ngIf="loading" class="flex items-center justify-center py-12">
            <div class="animate-spin rounded-full h-10 w-10 border-b-2" [style.border-color]="'var(--color-primary)'"></div>
            <span class="ml-3 text-gray-600 text-lg">Cargando gerentes...</span>
          </div>
          
          <div
            class="table-responsive my-4"
            *ngIf="!loading && listGerenteNoAsignados.length > 0; else no_municipio_content"
          >
            <table
              class="table text-center align-middle w-100"
              datatable
              [dtOptions]="dtOptionsGerenteNoAsignados"
              [dtTrigger]="dtTrigger"
            >
              <thead class="align-middle" [style.background]="'linear-gradient(to right, rgba(var(--color-primary-rgb), 0.1), rgba(var(--color-primary-rgb), 0.15))'">
                <tr>
                  <th scope="col" class="font-semibold py-4 px-4" [style.color]="'var(--color-primary)'">NOMBRE COMPLETO</th>
                  <th scope="col" class="font-semibold py-4 px-4" [style.color]="'var(--color-primary)'">TELÉFONO</th>
                  <th scope="col" class="font-semibold py-4 px-4" [style.color]="'var(--color-primary)'">CORREO ELECTRONICO</th>
                  <th scope="col" class="font-semibold py-4 px-4" [style.color]="'var(--color-primary)'"></th>
                </tr>
              </thead>
              <tbody>
                <tr
                  class="text-center hover:bg-gray-50 transition-colors duration-200 border-b border-gray-100"
                  *ngFor="
                    let gerente of listGerenteNoAsignados;
                    let index = index
                  "
                >
                  <td class="py-4 px-4 text-gray-900 font-medium">{{ gerente.nombres }} {{ gerente.apellidos }}</td>
                  <td class="py-4 px-4 text-gray-700">{{ gerente.telefono }}</td>
                  <td class="py-4 px-4 text-gray-700">{{ gerente.email }}</td>
                  <td class="py-4 px-4">
                    <div
                      class="flex flex-wrap gap-2 justify-center items-center"
                    >
                      <button
                        class="p-2 rounded-lg hover:bg-gray-100 transition-all duration-200"
                        [style.color]="'var(--color-primary)'"
                        data-bs-toggle="modal"
                        data-bs-target="#gerente"
                        (click)="gerenteActualSeleccionado(gerente)"
                        data-bs-placement="top"
                        title="Ver más"
                      >
                        <i class="fa-solid fa-eye"></i>
                      </button>
                      <button
                        class="p-2 rounded-lg hover:bg-gray-100 transition-all duration-200"
                        [style.color]="'var(--color-primary)'"
                        (click)="redirectUpdateGerente(gerente.id)"
                        data-bs-placement="top"
                        title="Editar información"
                      >
                        <i class="fa-solid fa-pen"></i>
                      </button>
                      <!--<button class="btn align-middle" data-bs-placement="top"
                                                title="Cambiar de rol" (click)="redirectSwitchRolGerente(gerente.id)">
                                                <img src="../../../../assets/changeRol.svg" class="icon-change-rol">
                                            </button>-->
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <ng-template #no_municipio_content>
            <div class="text-center py-12" *ngIf="!loading">
              <i class="fas fa-users text-5xl mb-4" [style.color]="'rgba(var(--color-primary-rgb), 0.3)'"></i>
              <p class="text-gray-600 text-lg">
                No hay gerentes sin asignación de municipio.
              </p>
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</div>

<div
  class="modal fade"
  id="gerente"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content rounded-2xl overflow-hidden">
      <div class="modal-header text-white py-4 px-6" [style.background]="'linear-gradient(to right, var(--color-primary), var(--color-accent))'">
        <h5 class="modal-title font-bold text-xl" id="exampleModalLabel">Información</h5>
        <button
          type="button"
          class="bg-transparent border-0 text-white hover:bg-white/20 rounded-lg p-2 transition-all duration-200"
          data-bs-dismiss="modal"
          aria-label="Close"
        >
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>
      <div class="modal-body">
        <p>
          <span class="fw-bolder">Nombre completo: </span
          ><span>
            {{ gerenteActual.nombres }} {{ gerenteActual.apellidos }}</span
          >
        </p>
        <p>
          <span class="fw-bolder">Teléfono: </span
          ><span> {{ gerenteActual.telefono }}</span>
        </p>
        <p>
          <span class="fw-bolder">Correo electrónico: </span
          ><span> {{ gerenteActual.email }}</span>
        </p>
        <p>
          <span class="fw-bolder">Número de documento: </span
          ><span> {{ gerenteActual.numero_documento }}</span>
        </p>
        <p [ngClass]="{ 'd-none': !municipiosActual }">
          <span class="fw-bolder">Municipios: </span
          ><span> {{ municipiosActual }}</span>
        </p>
      </div>
    </div>
  </div>
</div>
